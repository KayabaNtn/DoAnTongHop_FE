<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Cats Sport Academy</title>
    <link href="./assets/css/FE_83_NV.css" rel="stylesheet">
    <link href="./assets/css/responsive.css" rel="stylesheet">
    <link href="./assets/fonts/themify-icons.css" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
          integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
          referrerpolicy="no-referrer" rel="stylesheet"/>

</head>
<body>

<div id="main">

    <div id="header">
        <!-- Begin : nav -->
        <ul id="nav"> <!--ul#nav>li*5 -->
            <a><img alt="abc" class="logo" src="./assets/image/logo.jpg"></a>
            <li><a href="#bodys">HOME</a></li>
            <li><a href="../Nhanvien/FE_30_NV.html">Nhân Viên</a></li>
            <li><a href="../Nhanvien/FE_73_NV.html">Cập Nhật</a></li>
            <li><a href="../Nhanvien/FE_78_NV.html">Khóa Học</a></li>
            <li><a href="../Nhanvien/FE_88_NV.html">Đánh Giá</a></li>
            <li><a href="../Nhanvien/FE_83_NV.html">Điểm Học Viên</a></li>
            <li><a href="#footer">Giới thiệu</a></li>
        </ul>
        <!-- End : nav -->
        <!-- Begin : search button -->
        <div class="search-btn">
            <i class="search-icon ti-search"></i>
        </div>
        <div class="search-btn1">
            <p class="fix">Sengphet PHILAVONG<br>
                Quản lí </p>
        </div>
        <!-- End : search button -->
    </div>

    <div id="bodys">
        <div class="form-student">
            <h2>Cập nhật điểm cho học viên</h2>

            <label>Tên học viên :</label>
            <input class="form_st_input" disabled id="tenHV" placeholder="Seng Phet" tabindex="1" type="text">
            <br>

            <label>Ngày sinh :</label>
            <input class="form_st_input" disabled id="Date" placeholder="05/09/1990" tabindex="2"
                   type="text">
            <br>

            <label>Địa chỉ :</label>
            <input class="form_st_input" disabled id="diaChi" placeholder="Giải phóng" tabindex="3" type="text">
            <br>

            <label id="lblGender">Giới tính : </label>
            <input class="form_st_input" disabled id="male" name="gender" tabindex="4" type="radio"
                value="Nam "> Nam
            <input class="form_st_input" disabled id="female" name="gender" tabindex="4" type="radio"
                value="Nữ "> Nữ
            <br>
            <br>

            <label>Email :</label>
            <input class="form_st_input" disabled id="email" placeholder="*****@gmail.com" tabindex="5"
                   type="text">
            <br>

            <label>Số điện thoại :</label>
            <input class="form_st_input" disabled id="sdt" placeholder="0366******" tabindex="6" type="text">
            <br>

            <label>Điểm đánh giá :</label>
            <input class="" disabled id="diemDG" placeholder="khá" tabindex="7" type="text">
            <br>

            <label>Mật khẩu :</label>
            <input class="form_st_input" disabled id="matKhau" placeholder="05******" tabindex="8" type="text">
            <br>

            <label for="">&nbsp;</label>
            <button class="btn-save js-buy-ticket ">Feedback</button>
            <label for="">&nbsp;</label>
            <button class="btn-save" onclick="enableInputs()">Sửa</button>
            <label for="">&nbsp;</label>
            <button class="btn-save buttonSua" onclick="disableInputs()" >Hoàn Thành</button>
        </div>


    </div>



    <div id="footer">
        <div class="socials-list">
            <a href="#"><i class="ti-facebook"></i></a>
            <a href="#"><i class="ti-instagram"></i></a>
            <a href="#"><i class="ti-youtube"></i></a>
            <a href="#"><i class="ti-printerest"></i></a>
            <a href="#"><i class="ti-twitter"></i></a>
            <a href="#"><i class="ti-linkedin"></i></a>
        </div>
        <p class="copyright">
            Powered by <a href="#"> Cats Sport Academy
        </a>
        </p>
    </div>
</div>


<div class="modal js-modal">
    <div class="modal-container js-modal-container">
        <div class="modal-close js-modal-close ">
            <i class="ti-close"></i>
        </div>

        <header class="modal-header">
            <i class="modal-heading-icon ti-bag"></i>
            Thêm FeedBack
        </header>

        <div class="modal-body">

            <label class="modal-label" for="modal-IDHV">
                <i class="ti-user"></i>
                ID Nhân viên :
            </label>
            <input class="modal-input" id="modal-IDHV" placeholder="ID Nhân viên ?" type="text">
            

            <label class="modal-label" for="modal-feedback">
                <i class="ti-alarm-clock"></i>
                Feedback :
            </label>
            <input class="modal-input" id="modal-feedback" placeholder="Ngày ?" type="text">


            <button class=" js-buy-tickets save" id="buy-tickets" onclick="getValue()">
               Thêm FeedBack <i class="ti-check"></i>
            </button>

        </div>

        <footer class="modal-footer">
            <p class="modal-help">Need <a href="#">helf?</a></p>
        </footer>
    </div>
</div>

<script>
    const buyBtns = document.querySelectorAll('.js-buy-ticket')
    const modal = document.querySelector('.js-modal')
    const modalClose = document.querySelector('.js-modal-close')
    const modalbutton = document.querySelector('.js-buy-tickets')
    const buttonSua = document.querySelector('.buttonSua')
    const modalContainer = document.querySelector('.js-modal-container')
    function showBuy() {
        modal.classList.add('open')
    }

  

    function hideBuy() {
        modal.classList.remove('open')
    }

    for (const buyBtn of buyBtns) {
        buyBtn.addEventListener('click', showBuy)
    }
    
    modalClose.addEventListener('click', hideBuy)

    // Lưu phần tử input có thuộc tính disabled vào biến
    let myInputs = document.getElementsByClassName("form_st_input");

    modal.addEventListener('click', hideBuy)
     modalContainer.addEventListener('click', function (event) {
          event.stopPropagation()
      })
    
    // Bật thuộc tính disabled của phần tử input
    function enableInputs() {
        for (let i = 0; i < myInputs.length; i++) {
            myInputs[i].disabled = false;
        }
    }

    // Tắt thuộc tính disabled của phần tử input và chạy api update
    function disableInputs() {
        for (let i = 0; i < myInputs.length; i++) {
            myInputs[i].disabled = true;
        }

        async function Update(url = "", data = {}) {
        // Default options are marked with *
        const response = await fetch(url, {
            method: "PUT", // *GET, POST, PUT, DELETE, etc.
            mode: "cors", // no-cors, *cors, same-origin
            cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
            credentials: "same-origin", // include, *same-origin, omit
            headers: {
                "Content-Type": "application/json",
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            redirect: "follow", // manual, *follow, error
            referrerPolicy: "no-referrer", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        });
        return response.json(); // parses JSON response into native JavaScript objects
    }

   
    
        const edittenHV = document.getElementById("tenHV").value ;
        const editDate = document.getElementById("Date").value;
        const editdiaChi = document.getElementById("diaChi").value;
        var radios = document.getElementsByName('gender');
        var selectedGender;
        for (var i = 0; i < radios.length; i++) {
            if (radios[i].checked) {
                selectedGender = radios[i].value;
                break;
            }
        }
        const editemail = document.getElementById("email").value ;
        const editsdt = document.getElementById("sdt").value ;
        const editdiemDG = document.getElementById("diemDG").value ;
        const editmatKhau = document.getElementById("matKhau").value ;

        buttonSua.addEventListener('click', Update('http://localhost:8889/HocVien/update', {
            tenHv  :edittenHV,
            ngaySinh  :editDate,
            diaChi  :editdiaChi,
            gioiTinh  :selectedGender,
            email  :editemail,
            sdt  :editsdt,
            diemDanhGia  :editdiemDG,
            matKhau :editmatKhau,
        }).then((data) => {
            alert("Sửa học viên thành công")
            
        }));
    }

    
</script>
<!-- Thêm FeedBack  -->
<script>
      const Save = document.querySelector(" .save");
    

    // Example POST method implementation:
    async function Saves(url = "", data = {}) {
        // Default options are marked with *
        const response = await fetch(url, {
            method: "POST", // *GET, POST, PUT, DELETE, etc.
            mode: "cors", // no-cors, *cors, same-origin
            cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
            credentials: "same-origin", // include, *same-origin, omit
            headers: {
                "Content-Type": "application/json",
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            redirect: "follow", // manual, *follow, error
            referrerPolicy: "no-referrer", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        });
        return response.json(); // parses JSON response into native JavaScript objects
    }


    function getValue() {
        // Lấy tham chiếu đến phần tử input
    
        var inputfeedback = document.getElementById("modal-feedback").value;
        var inputtenHV = document.getElementById('modal-IDHV').value;
      
      
      

        Save.addEventListener('click', Saves("", {
            idHlv : inputtenHV,
            feedBack: inputfeedback,
           
        }).then((data) => {
            alert("Thành công")
            console.log(data); // JSON data parsed by `data.json()` call
        }));


    }
</script>
</body>
</html>
